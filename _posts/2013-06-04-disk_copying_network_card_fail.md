---
layout: default
title: 硬盘对拷网卡不可用的解决方法
category: Linux_tools
---

##{{ page.title }}

###硬盘克隆命令

很多人会有分区克隆的需求，例如硬盘不够用了，或者搭建集群时

硬盘克隆最简单的是使用linux默认命令：

*dd bs=4M if=/dev/sda of=/dev/sdb

注意：在拷贝前，请尽可能地关闭主机中的进程，不然可能会造成某些硬盘区域可能一部分是旧的数据，而另一半是新的数据，博主用了接近20个东芝300G 企业级硬盘进行测试,其中有两个出现系统启动时某些服务出错的问题，可以完好的概率还是蛮大的，失败还可以重新克隆，克隆一个300G的硬盘大约需要40分钟，这也取决于你的处理器和硬盘的读写速度

###网卡的问题及其解决方案

硬盘克隆后容易出现的问题是网卡存在，但启动之后总是失败(`ifconfig eth2 up`),这是由于网卡MAC地址与原来的网卡MAC地址不同，而linux内核会在启动时重新检测硬件,当它发现MAC地址不同时，则认为是新的网卡，所以将名字更名为eth2,eth3(假设原来的网卡名字为eth0,eth1)

解决方法：

####查看内核检测信息

*vim /var/log/dmesg

搜索eth，可以看到内核对网卡进行重命名的信息

####查看网卡规则

*vim /etc/udev/rule.d/70-persistent-net.rules

修改eth编号，修改的时候请严格参照上一步骤得到的网卡名，删除错误的网卡名

####重启

问题解决



